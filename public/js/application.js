!function(){"use strict";function e(e,t){var n={};return n}angular.module("AppService",["ngRoute"]).factory("AppService",e),e.$inject=["$location","$window"]}(),function(){"use strict";function e(e,t,n,o){var a={};return a.logout=function(){o.setToken(),n.path("/")},a.isLoggedIn=function(){return o.getToken()?!0:!1},a.getUser=function(){return o.getToken()?e.get("/api/me"):t.reject({message:"User has no token"})},a}function t(e){var t={};return t.getToken=function(){return e.get("token")},t.setToken=function(t){t?e.put("token",t):e.remove("token")},t}function n(e,t,n){var o={};return o.request=function(e){var t=n.getToken();return t&&(e.headers["x-access-token"]=t),e},o.responseError=function(o){return 403==o.status&&(n.setToken(),t.path("/")),e.reject(o)},o}angular.module("AuthService",[]).factory("Auth",e).factory("AuthToken",t).factory("AuthInterceptor",n),e.$inject=["$http","$q","$location","AuthToken"],t.$inject=["$cookies"],n.$inject=["$q","$location","AuthToken"]}(),function(){"use strict";function e(e,t,n){var o=this;o.initialize=function(){n.getUser().then(function(e){e.data.success?o.user=e.data.data:delete o.user,o.isLoggedIn=o.user?!0:!1,console.log("USER : ",o.user)})},o.initialize(),e.$on("$routeChangeStart",o.initialize),o.login=function(){t.location.href="/auth/instagram"},o.logout=function(){console.log("logout"),n.logout(),delete o.user},o.menuStyle="collapse navbar-collapse",o.menuClick=function(){"navbar-collapse"==o.menuStyle?o.menuStyle="collapse navbar-collapse":o.menuStyle="navbar-collapse"}}angular.module("AppController",[]).controller("AppController",e),e.$inject=["$rootScope","$window","Auth"]}(),function(){"use strict";function e(e,t,n){var o=this;o.leftPanel="",o.myIgPics=[],o.igShow=function(){"igShow"==o.leftPanel?(o.leftPanel="",document.querySelector("#map").className="map_inactive",document.querySelector("#side").className="side_inactive"):"igNew"==o.leftPanel?(o.leftPanel="igShow",document.querySelector("ig-show").className="",document.querySelector("ig-new").className="hidden"):(o.leftPanel="igShow",document.querySelector("ig-show").className="",document.querySelector("ig-new").className="hidden",document.querySelector("#map").className="map_active",document.querySelector("#side").className="side_active")},o.igIndex=function(){e.get("api/my_ig").success(function(e){e.success?o.myIgPics=e.data:(alert("Something went Wrong, please login again.."),n.logout())}).error(function(e){alert("Something went Wrong, please login again.."),n.logout()})},o.igNew=function(){console.log("IGNEW :",o.leftPanel),"igNew"==o.leftPanel?(o.leftPanel="",document.querySelector("#map").className="map_inactive",document.querySelector("#side").className="side_inactive"):"igShow"==o.leftPanel?(o.leftPanel="igNew",document.querySelector("ig-show").className="hidden",document.querySelector("ig-new").className="",o.igIndex()):(o.leftPanel="igNew",document.querySelector("ig-show").className="hidden",document.querySelector("ig-new").className="",document.querySelector("#map").className="map_active",document.querySelector("#side").className="side_active",o.igIndex())},o.igNewPicId=void 0,o.selectPic=function(e){if(o.igNewPicId){o.igNewPicId=void 0;for(var t=document.querySelectorAll(".my_ig_pic_con_hidden"),n=0;n<t.length;n++)t[n].className="col-xs-4 my_ig_pic_con";document.getElementById(e).className="col-xs-4 my_ig_pic_con"}else{o.igNewPicId=e;for(var a=document.querySelectorAll(".my_ig_pic_con"),n=0;n<a.length;n++)a[n].className="my_ig_pic_con_hidden";document.getElementById(e).className="my_ig_pic_con_selected",o.igShowSelectedPic=e}},o.finalLatLng={},o.locationAddress="",o.locationAddressSearchResults="",o.findByAddress=function(){e.get("api/find_location_by_address",{params:{address:o.locationAddress}}).success(function(e){e.success?(o.locationAddressSearchResults=e.data,console.log(o.locationAddressSearchResults)):(alert("Something went Wrong, please login again.."),n.logout())}).error(function(e){alert("Something went Wrong, please login again.."),n.logout()})},o.selectedAddress={},o.selectAddress=function(e){var t=document.getElementById("address_"+o.selectedAddressId);o.selectedAddress.name=t.dataset.name,o.selectedAddress.lat=t.dataset.lat,o.selectedAddress.lng=t.dataset.lng,o.finalLatLng.lat=t.dataset.lat,o.finalLatLng.lng=t.dataset.lng},o.placeName="",o.placeNameSearchResults="",o.findByPlaceName=function(){e.get("api/find_location_by_place_name",{params:{lat:o.selectedAddress.lat,lng:o.selectedAddress.lng,placename:o.placeName}}).success(function(e){e.success?(o.placeNameSearchResults=e.data.results,console.log(e.data.results)):(alert("Something went Wrong, please login again.."),n.logout())}).error(function(e){alert("Something went Wrong, please login again.."),n.logout()})},o.selectedPlaceName={},o.selectPlaceName=function(){var e=document.getElementById("place_"+o.selectedPlaceNameId);o.selectedPlaceName.name=e.dataset.name,o.selectedPlaceName.lat=e.dataset.lat,o.selectedPlaceName.lng=e.dataset.lng,o.finalLatLng.lat=e.dataset.lat,o.finalLatLng.lng=e.dataset.lng,console.log(o.selectedPlaceName)},o.markers=[{lat:34.052,lng:-118.243,latVol:-1e-5,lngVol:-1e-5,imgUrl:"http://www.keenthemes.com/preview/metronic/theme/assets/global/plugins/jcrop/demos/demo_files/image1.jpg"},{lat:34.062,lng:-118.243,latVol:1e-5,lngVol:-1e-5,imgUrl:"http://www.keenthemes.com/preview/metronic/theme/assets/global/plugins/jcrop/demos/demo_files/image1.jpg"}];var a={lat:34.05223,lng:-118.24368};document.getElementById("map").style.height=window.innerHeight-50+"px",document.querySelector("ig-show").className="hidden",document.querySelector("ig-new").className="hidden";var l=function(){var e={zoom:12,center:new google.maps.LatLng(a.lat,a.lng)};o.map=new google.maps.Map(document.getElementById("map"),e),o.markers.forEach(function(e){e.marker=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e.lng),title:"my marker",icon:new google.maps.MarkerImage(e.imgUrl,null,null,null,new google.maps.Size(60,60))}),e.marker.setMap(o.map),google.maps.event.addListener(e.marker,"click",o.igShow)}),setInterval(function(){o.markers.forEach(function(e){e.lat+=e.latVol,e.lng+=e.lngVol,e.marker.setPosition(new google.maps.LatLng(e.lat,e.lng))})},100)};l(),console.dir(o.map)}angular.module("MapController",[]).controller("MapController",e),e.$inject=["$http","$window","Auth"]}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"directives/ig_show.html"}}function t(){return{restrict:"E",templateUrl:"directives/ig_new.html"}}angular.module("MapDirectives",[]).directive("igShow",e).directive("igNew",t)}(),function(){"use strict";function e(e,t){e.when("/",{templateUrl:"views/welcome.html",controller:"AppController",controllerAs:"appCtrl",requireLogin:!1}).when("/app",{templateUrl:"views/app.html",controller:"MapController",controllerAs:"mapCtrl",requireLogin:!0}).otherwise("/"),t.html5Mode(!0)}angular.module("app.routes",["ngRoute"]).config(e),e.$inject=["$routeProvider","$locationProvider"]}(),function(){"use strict";function e(e){e.interceptors.push("AuthInterceptor")}function t(e,t,n,o){e.$on("$locationChangeStart",function(e,a,l){for(var c in t.routes)-1!=a.indexOf(c)&&t.routes[c].requireLogin&&!o.isLoggedIn()&&(alert("Please login first :D"),e.preventDefault(),n.location.href="/")})}angular.module("iBalloon",["app.routes","ngCookies","AppController","MapController","AppService","AuthService","MapDirectives"]).config(e).run(t),e.$inject=["$httpProvider"],t.$inject=["$rootScope","$route","$window","Auth"]}();